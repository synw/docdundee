"use strict";function e(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function c(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,c)}l((n=n.apply(e,t||[])).next())}))}
/*! js-cookie v3.0.1 | MIT */function t(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)e[n]=o[n]}return e}Object.defineProperty(exports,"__esModule",{value:!0});var o=function e(o,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=t({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var c in i)i[c]&&(s+="; "+c,!0!==i[c]&&(s+="="+i[c].split(";")[0]));return document.cookie=e+"="+o.write(r,e)+s}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],n={},r=0;r<t.length;r++){var i=t[r].split("="),s=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(n[c]=o.read(s,c),e===c)break}catch(e){}}return e?n[e]:n}},remove:function(e,o){r(e,"",t({},o,{expires:-1}))},withAttributes:function(o){return e(this.converter,t({},this.attributes,o))},withConverter:function(o){return e(t({},this.converter,o),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(o)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});exports.useApi=(t={serverUrl:"",csrfCookieName:"csrftoken",csrfHeaderKey:"X-CSRFToken",credentials:"include",mode:"cors"})=>{var n,r,i,s,c;let l,d=null!==(n=t.serverUrl)&&void 0!==n?n:"",u=null!==(r=null==t?void 0:t.csrfCookieName)&&void 0!==r?r:"csrftoken",a=null!==(i=null==t?void 0:t.csrfHeaderKey)&&void 0!==i?i:"X-CSRFToken",f=null!==(s=null==t?void 0:t.mode)&&void 0!==s?s:"cors",v=null!==(c=t.credentials)&&void 0!==c?c:"include",p=null,g={},h=!1;const y=()=>!!o.get(u),m=t=>e(void 0,void 0,void 0,(function*(){var e;const o={};t.headers.forEach(((e,t)=>o[t]=e));let n={ok:t.ok,url:t.url,headers:o,status:t.status,statusText:t.statusText,data:{},text:""};if(204!=t.status)if(null===(e=t.headers.get("Content-Type"))||void 0===e?void 0:e.startsWith("application/json"))try{n.data=yield t.json()}catch(e){console.warn(`Json parsing error: ${e}`)}else{const e=yield t.text();n.text=e}return l&&(n=yield l(n)),n})),C=(e="get")=>{const t={method:e,mode:f};null!==v&&(t.credentials=v);return t.headers=T({"Content-Type":"application/json"}),t},k=(e,t="post",o=!1)=>{const n=o?e:JSON.stringify(e),r={method:t,mode:f,body:n};let i;return i=o?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"},null!==v&&(r.credentials=v),r.headers=T(i),r};function T(e){if(null!==p&&(e[a]=p),h)for(const[t,o]of Object.entries(g))e[t]=o;return e}return{csrfToken:()=>p,hasCsrfCookie:y,setCsrfToken:e=>{p=e},setCsrfTokenFromCookie:(e=!1)=>y()?(p=(()=>{const e=o.get(u);if(!e)throw"Csrf cookie not found";return e})(),e&&console.log("User logged in with csrf cookie, setting api token",p),!0):(e&&console.log("User does not have csrf cookie"),!1),addHeader:(e,t)=>{g[e]=t,h=!0},removeHeader:e=>{delete g[e],0==Object.keys(g).length&&(h=!1)},onResponse:e=>{l=e},get:(t,o=!1)=>e(void 0,void 0,void 0,(function*(){let e=d+t;const n=C("get");o&&(console.log("GET",e),console.log(JSON.stringify(n,null,"  ")));const r=yield fetch(e,n);return yield m(r)})),post:(t,o,n=!1,r=!1)=>e(void 0,void 0,void 0,(function*(){const e=k(o,"post",n);let i=d+t;r&&(console.log("POST",i),console.log(JSON.stringify(e,null,"  ")));const s=yield fetch(i,e);return yield m(s)})),put:(t,o,n=!1)=>e(void 0,void 0,void 0,(function*(){let e=d+t;const r=k(o,"put");n&&(console.log("PUT",e),console.log(JSON.stringify(r,null,"  ")));const i=yield fetch(e,r);return yield m(i)})),patch:(t,o,n=!1)=>e(void 0,void 0,void 0,(function*(){const e=k(o,"patch");let r=d+t;n&&(console.log("PATCH",r),console.log(JSON.stringify(e,null,"  ")));const i=yield fetch(r,e);return yield m(i)})),del:(t,o=!1)=>e(void 0,void 0,void 0,(function*(){const e=d+t,n=C("delete");o&&(console.log("DELETE",e),console.log(JSON.stringify(n,null,"  ")));const r=yield fetch(e,n);return yield m(r)}))}};
