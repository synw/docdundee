var $api=function(e){"use strict";function t(e,t,o,n){return new(o||(o=Promise))((function(r,i){function c(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(c,s)}l((n=n.apply(e,t||[])).next())}))}
/*! js-cookie v3.0.1 | MIT */function o(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)e[n]=o[n]}return e}var n=function e(t,n){function r(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=o({},n,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var s in i)i[s]&&(c+="; "+s,!0!==i[s]&&(c+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+c}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var o=document.cookie?document.cookie.split("; "):[],n={},r=0;r<o.length;r++){var i=o[r].split("="),c=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(n[s]=t.read(c,s),e===s)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){r(e,"",o({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,o({},this.attributes,t))},withConverter:function(t){return e(o({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});return e.useApi=(e={serverUrl:"",csrfCookieName:"csrftoken",csrfHeaderKey:"X-CSRFToken",credentials:"include",mode:"cors"})=>{var o,r,i,c,s;let l,d=null!==(o=e.serverUrl)&&void 0!==o?o:"",u=null!==(r=null==e?void 0:e.csrfCookieName)&&void 0!==r?r:"csrftoken",a=null!==(i=null==e?void 0:e.csrfHeaderKey)&&void 0!==i?i:"X-CSRFToken",f=null!==(c=null==e?void 0:e.mode)&&void 0!==c?c:"cors",v=null!==(s=e.credentials)&&void 0!==s?s:"include",p=null,g={},h=!1;const y=()=>!!n.get(u),m=e=>t(void 0,void 0,void 0,(function*(){var t;const o={};e.headers.forEach(((e,t)=>o[t]=e));let n={ok:e.ok,url:e.url,headers:o,status:e.status,statusText:e.statusText,data:{},text:""};if(204!=e.status)if(null===(t=e.headers.get("Content-Type"))||void 0===t?void 0:t.startsWith("application/json"))try{n.data=yield e.json()}catch(e){console.warn(`Json parsing error: ${e}`)}else{const t=yield e.text();n.text=t}return l&&(n=yield l(n)),n})),C=(e="get")=>{const t={method:e,mode:f};null!==v&&(t.credentials=v);return t.headers=T({"Content-Type":"application/json"}),t},k=(e,t="post",o=!1)=>{const n=o?e:JSON.stringify(e),r={method:t,mode:f,body:n};let i;return i=o?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"},null!==v&&(r.credentials=v),r.headers=T(i),r};function T(e){if(null!==p&&(e[a]=p),h)for(const[t,o]of Object.entries(g))e[t]=o;return e}return{csrfToken:()=>p,hasCsrfCookie:y,setCsrfToken:e=>{p=e},setCsrfTokenFromCookie:(e=!1)=>y()?(p=(()=>{const e=n.get(u);if(!e)throw"Csrf cookie not found";return e})(),e&&console.log("User logged in with csrf cookie, setting api token",p),!0):(e&&console.log("User does not have csrf cookie"),!1),addHeader:(e,t)=>{g[e]=t,h=!0},removeHeader:e=>{delete g[e],0==Object.keys(g).length&&(h=!1)},onResponse:e=>{l=e},get:(e,o=!1)=>t(void 0,void 0,void 0,(function*(){let t=d+e;const n=C("get");o&&(console.log("GET",t),console.log(JSON.stringify(n,null,"  ")));const r=yield fetch(t,n);return yield m(r)})),post:(e,o,n=!1,r=!1)=>t(void 0,void 0,void 0,(function*(){const t=k(o,"post",n);let i=d+e;r&&(console.log("POST",i),console.log(JSON.stringify(t,null,"  ")));const c=yield fetch(i,t);return yield m(c)})),put:(e,o,n=!1)=>t(void 0,void 0,void 0,(function*(){let t=d+e;const r=k(o,"put");n&&(console.log("PUT",t),console.log(JSON.stringify(r,null,"  ")));const i=yield fetch(t,r);return yield m(i)})),patch:(e,o,n=!1)=>t(void 0,void 0,void 0,(function*(){const t=k(o,"patch");let r=d+e;n&&(console.log("PATCH",r),console.log(JSON.stringify(t,null,"  ")));const i=yield fetch(r,t);return yield m(i)})),del:(e,o=!1)=>t(void 0,void 0,void 0,(function*(){const t=d+e,n=C("delete");o&&(console.log("DELETE",t),console.log(JSON.stringify(n,null,"  ")));const r=yield fetch(t,n);return yield m(r)}))}},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
